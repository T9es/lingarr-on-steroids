import{A as L,z as D,b as i,e as a,k as e,d as F,r as h,c as A,w as U,f as I,p as m,T as O,q as H,_ as W,x as M,F as C,y as V,D as _,j as T,E as q,o as R,C as Y,H as Z,g as b}from"./index-Ch4LkV9I.js";import{M as j}from"./index-ML11zQTX.js";import{_ as G}from"./SelectComponent.vue_vue_type_script_setup_true_lang-Bg1pAB5D.js";import{T as E}from"./TimesIcon-BnWx0jvB.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{L as J}from"./LoaderCircleIcon--TJ8BGW4.js";import{d as K}from"./delay-NRuupcPE.js";import"./CaretRightIcon-0y92JSx2.js";import"./useClickOutside-CMGy5ibi.js";const Q=L("mapping",{state:()=>({mappings:[],error:null}),actions:{async fetchMappings(){this.error=null;try{this.mappings=await D.mapping.getMappings()}catch{this.error="Failed to fetch mappings"}},async setMappings(o){this.error=null;try{await D.mapping.setMappings(o),this.mappings=o}catch{this.error="Failed to set mappings"}},addMapping(o){this.mappings.push(o)},removeMapping(o){this.mappings.splice(o,1)},updateMapping(o,s){this.mappings[o]=s}},getters:{getMappingByIndex:o=>s=>o.mappings[s],getMappingsByMediaType:o=>s=>o.mappings.filter(v=>v.mediaType===s)}}),X={},ee={viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"};function te(o,s){return a(),i("svg",ee,[...s[0]||(s[0]=[e("path",{d:"M5 12h14"},null,-1),e("path",{d:"M12 5v14"},null,-1)])])}const B=N(X,[["render",te]]),se={},ne={viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"};function oe(o,s){return a(),i("svg",ne,[...s[0]||(s[0]=[e("path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"},null,-1),e("path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"},null,-1),e("path",{d:"M7 3v4a1 1 0 0 0 1 1h7"},null,-1)])])}const ae=N(se,[["render",oe]]),ie={class:"shell-scroll grow overflow-auto text-sm"},le={class:"mb-2 text-gray-400"},re={key:0,class:"flex items-center p-1"},ce={class:"flex items-center p-1"},de=["onClick"],pe={class:"space-y-1 text-gray-400 select-none"},ue=["onClick","onDblclick"],me={class:"truncate"},ve=F({__name:"DirectoryModal",props:{isOpen:{type:Boolean}},emits:["close","select"],setup(o,{emit:s}){const v=o,k=s,d=h("/"),w=h([]),p=h(null),P=h([]),S=n=>{w.value=n==="/"?[]:n.split("/").filter(Boolean)},x=async n=>{try{P.value=await D.directory.get(n),d.value=n,S(n),p.value=null}catch{}},$=async()=>{await x("/")},c=async()=>{if(d.value==="/")return;const n=d.value.split("/").slice(0,-1).join("/")||"/";await x(n)},t=A(()=>d.value==="/"?["..."]:["...",...d.value.split("/").filter(Boolean)]),l=async n=>{let r;n===0?r="/":r="/"+t.value.slice(1,n+1).join("/"),await x(r)},f=n=>{p.value=n},g=n=>{n.name==="..."?c():x(n.fullPath)},z=()=>{p.value&&k("select",p.value.fullPath)};return U(()=>v.isOpen,n=>{n&&$()}),(n,r)=>(a(),I(W,{to:"body"},[m(O,{"enter-active-class":"transition-all duration-300 ease-in-out","leave-active-class":"transition-all duration-300 ease-in-out","enter-from-class":"opacity-0","leave-to-class":"opacity-0"},{default:H(()=>[o.isOpen?(a(),i("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",onClick:r[1]||(r[1]=u=>n.$emit("close"))},[m(O,{"enter-active-class":"transition-transform duration-300 ease-in-out","leave-active-class":"transition-transform duration-300 ease-in-out","enter-from-class":"scale-90","leave-to-class":"scale-90"},{default:H(()=>[e("div",{class:"flex h-96 w-full max-w-md flex-col rounded-lg bg-black p-2",onClick:r[0]||(r[0]=q(()=>{},["stop"]))},[e("div",ie,[e("div",le,[d.value.length>0?(a(),i("div",re,[e("button",{class:"mr-2",onClick:c},[...r[2]||(r[2]=[e("svg",{class:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"m12 19-7-7 7-7"}),e("path",{d:"M19 12H5"})],-1)])]),e("div",ce,[(a(!0),i(C,null,V(t.value,(u,y)=>(a(),i(C,{key:y},[e("span",{class:_([{hidden:y<t.value.length-3&&t.value.length>3},"cursor-pointer"]),onClick:je=>l(y)},T(u),11,de),y<t.value.length-1?(a(),i("span",{key:0,class:_([{hidden:y<t.value.length-3&&t.value.length>3},"mx-1"])}," / ",2)):M("",!0)],64))),128))])])):M("",!0)]),e("div",pe,[(a(!0),i(C,null,V(P.value,u=>(a(),i("div",{key:u.fullPath,class:_(["flex cursor-pointer items-center rounded-md p-1 transition duration-300",{"bg-gray-900":p.value===u,"hover:brightness-150":p.value!==u}]),onClick:y=>f(u),onDblclick:y=>g(u)},[r[3]||(r[3]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"mr-2 h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"})],-1)),e("span",me,T(u.name),1)],42,ue))),128))])]),e("div",{class:"flex justify-end pt-2"},[e("div",{class:"inline-flex cursor-pointer items-center rounded-md border border-gray-600 px-4 py-1 text-gray-400 transition duration-300 hover:border-gray-500 hover:text-gray-400",onClick:z}," Select ")])])]),_:1})])):M("",!0)]),_:1})]))}}),he={class:"w-full"},fe={class:"bg-tertiary flex items-center justify-between gap-2 p-4"},ge={class:"flex space-x-4"},ye={class:"w-full px-4"},_e={class:"float-right md:hidden"},ke={class:"mb-2 md:col-span-4 md:mb-0 md:px-4 md:py-2"},xe={key:0,class:"bg-secondary rounded-md px-2 py-1"},we=["onClick"],be={class:"mb-2 md:col-span-4 md:mb-0 md:px-4 md:py-2"},Me={key:0,class:"bg-secondary rounded-md px-2 py-1"},Ce=["onClick"],Pe={class:"mb-2 md:col-span-3 md:mb-0 md:px-4 md:py-2"},$e={class:"hidden items-center justify-between md:col-span-1 md:flex md:justify-end md:px-4 md:py-2"},Fe=F({__name:"MappingPage",setup(o){const s=Q(),v=h(!1),k=h(!1),d=h("source"),w=h(0),p=(c,t)=>{d.value=c,w.value=t,k.value=!0},P=c=>{const t=s.getMappingByIndex(w.value);d.value==="source"?t.sourcePath=c:t.destinationPath=c,s.updateMapping(w.value,t),k.value=!1},S=async()=>{v.value||(v.value=!0,await s.setMappings(s.mappings),await K(1e3),v.value=!1)},x=()=>{s.addMapping({sourcePath:"",destinationPath:"",mediaType:void 0})},$=c=>{s.removeMapping(c)};return R(async()=>{await s.fetchMappings()}),(c,t)=>(a(),i(C,null,[e("div",he,[e("div",fe,[t[1]||(t[1]=Y(" Source mapping ",-1)),e("div",ge,[e("button",{class:"text-blue-500 transition duration-300 hover:text-blue-600",onClick:x},[m(B,{class:"h-5 w-5"})]),v.value?(a(),I(J,{key:0,class:"h-5 w-5 animate-spin"})):(a(),I(ae,{key:1,class:"h-5 w-5 cursor-pointer",onClick:S}))])]),e("div",ye,[t[5]||(t[5]=Z('<div class="border-accent hidden border-b font-bold md:grid md:grid-cols-12"><div class="col-span-4 px-4 py-2">Source</div><div class="col-span-4 px-4 py-2">Target</div><div class="col-span-3 px-4 py-2">Media Type</div><div class="col-span-1 flex justify-end px-4 py-2"></div></div>',1)),(a(!0),i(C,null,V(b(s).mappings,(l,f)=>(a(),i("div",{key:`pair-${f}`,class:"md:border-accent rounded-lg py-4 shadow-sm md:grid md:grid-cols-12 md:rounded-none md:border-b md:bg-transparent md:p-0 md:shadow-none"},[e("div",_e,[m(E,{class:"h-5 w-5 cursor-pointer text-red-500 transition duration-300 hover:text-red-600",onClick:g=>$(f)},null,8,["onClick"])]),e("div",ke,[t[2]||(t[2]=e("span",{class:"font-bold md:hidden"},"Source: ",-1)),e("div",{class:_(["flex items-center",{"justify-between":l.sourcePath}])},[l.sourcePath?(a(),i("span",xe,T(l.sourcePath),1)):M("",!0),e("div",{class:_(["flex cursor-pointer",{"w-full justify-end":!l.sourcePath}]),onClick:g=>p("source",f)},[m(B,{class:"h-12 w-5"})],10,we)],2)]),e("div",be,[t[3]||(t[3]=e("span",{class:"font-bold md:hidden"},"Destination: ",-1)),e("div",{class:_(["flex items-center",{"justify-between":l.destinationPath}])},[l.destinationPath?(a(),i("span",Me,T(l.destinationPath),1)):M("",!0),e("div",{class:_(["flex cursor-pointer",{"w-full justify-end":!l.destinationPath}]),onClick:g=>p("target",f)},[m(B,{class:"h-12 w-5"})],10,Ce)],2)]),e("div",Pe,[t[4]||(t[4]=e("span",{class:"font-bold md:hidden"},"Media Type: ",-1)),m(G,{selected:l.mediaType,"onUpdate:selected":g=>l.mediaType=g,options:[{value:b(j).MOVIE,label:b(j).MOVIE},{value:b(j).SHOW,label:b(j).SHOW}]},null,8,["selected","onUpdate:selected","options"])]),e("div",$e,[m(E,{class:"h-5 w-5 cursor-pointer text-red-500 transition duration-300 hover:text-red-600",onClick:g=>$(f)},null,8,["onClick"])])]))),128))])]),m(ve,{"is-open":k.value,onClose:t[0]||(t[0]=l=>k.value=!1),onSelect:P},null,8,["is-open"])],64))}});export{Fe as default};
