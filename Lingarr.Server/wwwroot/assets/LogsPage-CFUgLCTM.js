import{d as C,r as v,c as D,w as $,o as E,z as x,a as O,b as p,k as e,j as s,L as U,a0 as j,x as h,F as B,y as M,C as R,D as _,n as A,e as u}from"./index-Ch4LkV9I.js";const F={class:"bg-secondary w-full p-4"},N={class:"border-secondary bg-primary text-secondary-content mb-4 border-b-2 font-bold"},V={class:"flex items-center justify-between px-4 py-3"},G={class:"text-xl"},H={class:"flex items-center space-x-3"},z={class:"flex items-center space-x-4"},I={value:"all"},J={value:"information"},P={value:"warning"},Z={value:"error"},q={class:"flex space-x-2"},K={class:"border-secondary bg-primary text-secondary-content grid grid-cols-12 border-b-2 font-bold"},Q={class:"col-span-1 px-4 py-2"},W={class:"col-span-1 px-4 py-2"},X={class:"col-span-3 px-4 py-2"},Y={class:"col-span-5 px-4 py-2 md:col-span-7"},ee={key:0,class:"flex h-full items-center justify-center"},te={class:"text-center text-gray-500"},se={class:"hover:bg-secondary/20 border-secondary/30 grid grid-cols-12 border-b py-2 transition-colors"},oe={class:"col-span-1 px-4 text-gray-400"},ae={class:"col-span-1 px-4"},ne={class:"col-span-3 px-4 text-blue-300"},re=["innerHTML"],le={key:0,class:"border-secondary/30 bg-error/5 ml-6 border-b py-2 pr-4 pl-12 text-xs"},ie={class:"whitespace-pre-wrap"},ce={class:"border-secondary bg-primary text-secondary-content mt-4 flex justify-between border-t-2 px-4 py-2 text-sm"},pe=C({__name:"LogsPage",setup(de){const r=v([]),l=v(!0),m=v(null),c=v({logLevel:"all"});let n=null;const d=D(()=>r.value.filter(t=>!(c.value.logLevel!=="all"&&t.logLevel.toLowerCase()!==c.value.logLevel.toLowerCase()))),L=t=>{let o=t.replace(/\|Green\|([^|]*)\|\/Green\|/g,'<span class="text-green-500">$1</span>').replace(/\|Red\|([^|]*)\|\/Red\|/g,'<span class="text-red-500">$1</span>').replace(/\|Orange\|([^|]*)\|\/Orange\|/g,'<span class="text-orange-500">$1</span>');return o=o.replace(/'([A-Z_]+)'/g,`<span class="text-accent">'$1'</span>`),o},w=t=>{const o=t.toLowerCase();return o.includes("error")?"bg-red-500/20 text-red-500":o.includes("warning")?"bg-orange-500/20 text-orange-500":o.includes("information")?"bg-green-500/20 text-green-500":"bg-info/20 text-info"},f=async()=>{l.value&&m.value&&(await A(),m.value.scrollTop=m.value.scrollHeight)},S=()=>{l.value=!l.value,l.value&&f()},k=()=>{r.value=[]},T=()=>{const o=`system-logs-${new Date().toISOString().replace(/[:.]/g,"-")}.txt`;let a=`System Logs Export
`;a+=`Generated: ${new Date().toLocaleString()}
`,a+=`Total Entries: ${d.value.length}
`,a+=`${"=".repeat(80)}

`,d.value.forEach(i=>{a+=`[${i.formattedDate} ${i.formattedTime}] [${i.logLevel}] [${i.category}] ${i.message}
`,i.stackTrace&&(a+=`Stack Trace:
${i.stackTrace}
`),a+=`
`});const y=new Blob([a],{type:"text/plain"}),b=window.URL.createObjectURL(y),g=document.createElement("a");g.href=b,g.download=o,document.body.appendChild(g),g.click(),document.body.removeChild(g),window.URL.revokeObjectURL(b)};return $(c,()=>{f()},{deep:!0}),E(()=>{n=x.logs.getStream(),n.onmessage=t=>{try{const o=JSON.parse(t.data);r.value=[...r.value,o],f()}catch(o){const a={logLevel:"Error",message:`Failed to process log data: ${typeof t.data=="string"?t.data.substring(0,100)+"...":"Invalid format"}`,formattedTime:new Date().toTimeString().split(" ")[0],formattedDate:new Date().toDateString(),formattedSource:"System",category:"System",stackTrace:o instanceof Error?o.stack:void 0};r.value=[...r.value,a]}},n.onerror=t=>{r.value.push({logLevel:"error",message:"Log stream connection error. Attempting to reconnect in 5 seconds...",formattedTime:new Date().toTimeString().split(" ")[0],formattedDate:new Date().toLocaleDateString(),formattedSource:"System",category:"System"}),n&&(n.close(),setTimeout(()=>{n=x.logs.getStream()},5e3))}}),O(()=>{n&&(n.close(),n=null)}),(t,o)=>(u(),p("div",F,[e("div",N,[e("div",V,[e("h1",G,s(t.translate("settings.logs.systemLogs")),1),e("div",H,[e("div",z,[U(e("select",{"onUpdate:modelValue":o[0]||(o[0]=a=>c.value.logLevel=a),class:"bg-secondary text-accent-content border-secondary rounded border px-2 py-1 text-sm"},[e("option",I,s(t.translate("settings.logs.allLevels")),1),e("option",J,s(t.translate("settings.logs.information")),1),e("option",P,s(t.translate("settings.logs.warning")),1),e("option",Z,s(t.translate("settings.logs.error")),1)],512),[[j,c.value.logLevel]])]),e("div",q,[e("button",{class:"bg-accent hover:bg-accent/80 cursor-pointer rounded px-3 py-1 text-sm font-medium text-white transition",onClick:T},s(t.translate("settings.logs.export")),1),e("button",{class:"bg-warning hover:bg-warning/80 cursor-pointer rounded px-3 py-1 text-sm font-medium text-white transition",onClick:S},s(l.value?t.translate("settings.logs.disableAutoScroll"):t.translate("settings.logs.enableAutoScroll")),1),e("button",{class:"bg-error hover:bg-error/80 cursor-pointer rounded px-3 py-1 text-sm font-medium text-white transition",onClick:k},s(t.translate("settings.logs.clear")),1)])])])]),e("div",K,[e("div",Q,s(t.translate("settings.logs.time")),1),e("div",W,s(t.translate("settings.logs.level")),1),e("div",X,s(t.translate("settings.logs.source")),1),e("div",Y,s(t.translate("settings.logs.message")),1)]),e("div",{ref_key:"logContainer",ref:m,class:"bg-primary text-accent-content h-[70vh] overflow-y-auto font-mono text-sm"},[d.value.length===0?(u(),p("div",ee,[e("div",te,[o[1]||(o[1]=e("div",{class:"mb-2 text-lg"},"ðŸ“‹",-1)),e("div",null,s(t.translate("settings.logs.waitingForLogs")),1)])])):h("",!0),(u(!0),p(B,null,M(d.value,(a,y)=>(u(),p("div",{key:y,class:"log-entry"},[e("div",se,[e("div",oe,s(a.formattedTime),1),e("div",ae,[e("span",{class:_([w(a.logLevel),"rounded px-2 py-1 text-xs font-medium"])},s(a.logLevel.toUpperCase()),3)]),e("div",ne,s(a.formattedSource),1),e("div",{class:"col-span-5 px-4 md:col-span-7",innerHTML:L(a.message)},null,8,re)]),a.stackTrace?(u(),p("div",le,[e("pre",ie,s(a.stackTrace),1)])):h("",!0)]))),128))],512),e("div",ce,[e("div",null,s(t.translate("settings.logs.totalEntries"))+": "+s(d.value.length),1),e("div",null,[R(s(t.translate("settings.logs.autoScroll"))+": ",1),e("span",{class:_(l.value?"text-success":"text-error")},s(l.value?t.translate("settings.logs.enabled"):t.translate("settings.logs.disabled")),3)])])]))}});export{pe as default};
